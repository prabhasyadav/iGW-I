
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>1. Conservative Transport &#8212; Groundwater I</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script src="../../../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2. Reactive Mass Transport" href="../L10/22_reactive_transport.html" />
    <link rel="prev" title="7. Wells" href="../../flow/L8/18_wells.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Groundwater I</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    The Interactive Groundwater-I Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/00_general.html">
   1. About this Groundwater Course and Contents
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/03_basic_hydrogeology.html">
   2. Course Introduction &amp; Water Cycle
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Flow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../flow/12_subsurface_structure.html">
   1. Subsurface Structure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flow/L3/13_gw_storage.html">
   2. Groundwater as a reservoir
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flow/L4/14_darcy_law_K.html">
   3. Darcy’s Law and Conductivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flow/L5/15_het_iso.html">
   4. Aquifer Heterogeneity and Anisotropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flow/L6/16_darcy_law_3D.html">
   5. Steady-State Groundwater flow in 3D
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flow/L7/17_quantify_flow.html">
   6. Quantifying 3D Groundwater Flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flow/L8/18_wells.html">
   7. Wells
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Transport
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Conservative Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../L10/22_reactive_transport.html">
   2. Reactive Mass Transport
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../modeling/31_intro_modeling.html">
   1. Background of Groundwater Modeling
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/01_python.html">
   1. Python Programming language
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/02_jupyter.html">
   2. JUPYTER Notebook Interface for Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T2/tutorial_02.html">
   3. Aquifer and Storage Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T3/tutorial_03.html">
   4. Darcy Law and Conductivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T4/tutorial_04.html">
   5. Effective K &amp; Recitation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T5/tutorial_05.html">
   6. Aquifer Heterogeneity/Anisotropy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T6/tutorial_06.html">
   7. Flow in Confined/Unconfined Aquifer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T7/tutorial_07.html">
   8. Wells
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T8/tutorial_08.html">
   9. Conservative transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/T9/tutorial_09.html">
   10. Reactive transport
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/decay.html">
   1. Simulating Mass Budget
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/sieve_analysis.html">
   2. Simulating Seive Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/effective_K.html">
   3. Simulating Effective hydraulic conductivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/uniform_flow_and_well.html">
   4. Uniform Flow and Well
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/aniso2D.html">
   5. Simulating the Anisotropy and flow direction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/type_curve_fit.html">
   6. Type curve and fitting pumping data tool
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/1D_advection_dispersion.html">
   7. Tool for simulating 1D Conservative Transport (Laboratory Column)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/Kinetics_degradation.html">
   8. Simulating Kinetics and Degradation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools/1D_ditchflow.html">
   9. Simulating 1D Trench Flow
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Previous Years Q&amp;A
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Q_and_A/GW_exam_2019_20.html">
   1. Groundwater Exam Solution -  2019-2020
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/iGW-TU-Dresden/iGW_Book/main?urlpath=tree/content/transport/L9/21_conservative_transport.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/iGW-TU-Dresden/iGW_Book/blob/main/content/transport/L9/21_conservative_transport.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/iGW-TU-Dresden/iGW_Book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/iGW-TU-Dresden/iGW_Book/issues/new?title=Issue%20on%20page%20%2Fcontent/transport/L9/21_conservative_transport.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/content/transport/L9/21_conservative_transport.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   1.1. Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#groundwater-flow-and-transport">
   1.2. Groundwater flow and transport
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conservative-transport-processes">
   1.3. Conservative transport processes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#advection">
     1.3.1. Advection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-advection-and-advective-mass-rate">
     1.3.2. 1D Advection and advective mass rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-advection-in-variable-cross-section">
     1.3.3. 1D advection in variable cross-section
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-advection-enough">
     1.3.4. Is advection enough?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mechanical-dispersion">
   1.4. Mechanical dispersion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dispersive-mass-flow-rate">
     1.4.1. Dispersive Mass flow rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dispersivity-and-mechanical-dispersion-coefficient">
     1.4.2. Dispersivity and Mechanical Dispersion coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hydrodynamic-dispersion">
     1.4.3. Hydrodynamic Dispersion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-diffusion">
   1.5. 1D Diffusion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1.5.1. Hydrodynamic Dispersion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#joint-action-of-transport-processes">
   1.6. Joint Action of Transport Processes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis-of-conservative-transport-problem">
   1.7. Analysis of conservative transport problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concnetration-profiles-and-breakthrough-curves">
   1.8. Concnetration Profiles and Breakthrough Curves
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-tool">
   1.9. Additional Tool
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-quiz">
   1.10. Chapter Quiz
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Conservative Transport</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   1.1. Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#groundwater-flow-and-transport">
   1.2. Groundwater flow and transport
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conservative-transport-processes">
   1.3. Conservative transport processes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#advection">
     1.3.1. Advection
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-advection-and-advective-mass-rate">
     1.3.2. 1D Advection and advective mass rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-advection-in-variable-cross-section">
     1.3.3. 1D advection in variable cross-section
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-advection-enough">
     1.3.4. Is advection enough?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mechanical-dispersion">
   1.4. Mechanical dispersion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dispersive-mass-flow-rate">
     1.4.1. Dispersive Mass flow rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dispersivity-and-mechanical-dispersion-coefficient">
     1.4.2. Dispersivity and Mechanical Dispersion coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hydrodynamic-dispersion">
     1.4.3. Hydrodynamic Dispersion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-diffusion">
   1.5. 1D Diffusion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1.5.1. Hydrodynamic Dispersion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#joint-action-of-transport-processes">
   1.6. Joint Action of Transport Processes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analysis-of-conservative-transport-problem">
   1.7. Analysis of conservative transport problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concnetration-profiles-and-breakthrough-curves">
   1.8. Concnetration Profiles and Breakthrough Curves
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-tool">
   1.9. Additional Tool
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-quiz">
   1.10. Chapter Quiz
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <aside class="sidebar">
<p class="sidebar-title">Additional Material : Lecture Slides</p>
<div class="toggle docutils container">
<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vSqv6pVW3kiG8Ng2pI7xDiD4I1anDqQZuiT1ktWscurKWfGrk9k-PGZ-2866XWgBA/embed?start=false&loop=false&delayms=3000" frameborder="0" width="480" height="389" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
</div>
</aside>
<div class="cell tag_hide-input tag_remove-input docutils container">
</div>
<section class="tex2jax_ignore mathjax_ignore" id="conservative-transport">
<h1><span class="section-number">1. </span>Conservative Transport<a class="headerlink" href="#conservative-transport" title="Permalink to this headline">#</a></h1>
<hr class="docutils" />
<section id="motivation">
<h2><span class="section-number">1.1. </span>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">#</a></h2>
<p>Groundwater is used by almost half of the world population for drinking purposes. Therefore maintaining it’s quality is very important, not only for human consumption but also for the maintenance of the ecosystem that we live. Groundwater contamination artificial (e.g., from human intervention) or natural (e.g., flood) can impact groundwater quality. Of these two, artificial contamination, e.g., industrial development, improper waste management is more alarming one as quite few contamination (e.g, fuels, radioactive waste) can remain in groundwater for very long time. In this lecture we will learn about processes affecting groundwater quality issues. It has to be mentioned that when we talk about groundwater quality, we mean the change in the original state of groundwater. At many instances this can be groundwater quality can be defined in terms of regulatory standards.</p>
</section>
<section id="groundwater-flow-and-transport">
<h2><span class="section-number">1.2. </span>Groundwater flow and transport<a class="headerlink" href="#groundwater-flow-and-transport" title="Permalink to this headline">#</a></h2>
<p>Before we begin, let us distinguish between <em>groundwater flow</em> and <em>transport</em> problems. With <em>flow</em> problems we deal with groundwater only, whereas with <em>transport</em> problem we deal with particles flowing along with groundwater. It is not required that particle be a contaminant. The particle in this sense may be defines as anything other than water. We begin with a groundwater contamination scenario.</p>
<figure class="align-center" id="trans-c-2d">
<a class="reference internal image-reference" href="../../../_images/T9_f1a.png"><img alt="../../../_images/T9_f1a.png" src="../../../_images/T9_f1a.png" style="width: 523.6px; height: 289.6px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.1 </span><span class="caption-text">Contamination scenario</span><a class="headerlink" href="#trans-c-2d" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In the figure, the chemicals (contaminants) first enters the <em>vadose zone</em>, an unstatured part of the subsurface from the ground surface. The entry is faciliated with phenomenan such as rainfall. As only limited water are available and there are almost no continuous horizontal flow, the contaminants, mostly as a pure phase,  in this zone often travels vertically until it reaches the groundwater table - a boundary between an unstaturated and saturated subsurface. Beneath the water-table, the contaminants mixes with the flowing groundwater and spreads both vertically and horizontally along the saturated zone resulting to a development of a contaminant plume.</p>
<p><strong>In this course we learn only of contamination in the saturated zone.</strong></p>
<p>Before we approach the transport processes, it is important that we learn about the category of groundwater problem. At the top-most level groundwater transport problem is categorized as</p>
<blockquote>
<div><ol class="simple">
<li><p><strong>Conservative transport problem</strong>: The transport problem which involves only movement of particles along with the water flow. We can call this as non-reactive transport problems, e.g., dye or (inert) salt transport. In this lecture we deal with this transport type.</p></li>
<li><p><strong>Reactive transport problem</strong>: The transport problem that deals with reaction along with the flow of particles. This is compound problem type in which flow properties, the conservative part of the transport problem, as well as the chemical properties (and reactions) is considered. Several types of reactions are possible and they need to be considered. We will deal with this type of transport problem in the next lecture.</p></li>
</ol>
</div></blockquote>
</section>
<section id="conservative-transport-processes">
<h2><span class="section-number">1.3. </span>Conservative transport processes<a class="headerlink" href="#conservative-transport-processes" title="Permalink to this headline">#</a></h2>
<p>As defined earlier and also shown in the figure, the three main processes active in conservative transport in groundwater are:</p>
<blockquote>
<div><ol class="simple">
<li><p>Advection</p></li>
<li><p>Dispersion</p></li>
<li><p>Diffusion</p></li>
</ol>
</div></blockquote>
<p>We discuss each of these process, learn to quantify them and then combine them to set-up of our system equation for groundwater transport problem.</p>
<section id="advection">
<h3><span class="section-number">1.3.1. </span>Advection<a class="headerlink" href="#advection" title="Permalink to this headline">#</a></h3>
<p><u>Advection</u>, also called <strong>convection</strong>, is the transport of components (matter or also energy) due to moving medium. The moving medium, i.e., <em>a carrier</em> is, usually groundwater. Thus, quantities that characterizes flow also characterizes advective transport.</p>
<p>Advective transport is not limited to groundwater system. Heating circuit, sailplaning are examples of convection of heat. Similarly, movement of suspended particles in the surface water or by the wind are few examples of advective transport in non-groundwater systems.</p>
<p>The term <strong>convection</strong> is more often associated with energy transport, whereas <strong>advection</strong> is frequently used for transport of the matter.</p>
</section>
<section id="d-advection-and-advective-mass-rate">
<h3><span class="section-number">1.3.2. </span>1D Advection and advective mass rate<a class="headerlink" href="#d-advection-and-advective-mass-rate" title="Permalink to this headline">#</a></h3>
<p>2D studies are more often the case used in exploring groundwater and its processes. 1D studies can also be sufficient to understand the <strong>flow</strong> dominated processes such as advection. Also, 1D study is more suitable in lab column studies, as often length of pipes are many times larger that its diameter. For advection, considering 1D pipe flow, to be considered are:</p>
<ul class="simple">
<li><p>Steady-state flow with discharge <span class="math notranslate nohighlight">\(Q\)</span> [L<span class="math notranslate nohighlight">\(^3\)</span>T<span class="math notranslate nohighlight">\(^{-1}\)</span>]</p></li>
<li><p>Cross-sectional area, a constant quantity,  <span class="math notranslate nohighlight">\(A\)</span> [L<span class="math notranslate nohighlight">\(^2\)</span>]</p></li>
<li><p>Fluid continuity equation: <span class="math notranslate nohighlight">\(Q= n_e\cdot A\cdot v\)</span> = constant, with <span class="math notranslate nohighlight">\(n_e\)</span>[-] is the <strong>effective</strong> porosity and <span class="math notranslate nohighlight">\(v\)</span> [LT<span class="math notranslate nohighlight">\(^{-1}\)</span>] the <strong>linear</strong> groundwater velocity</p></li>
</ul>
<p>With these information, the advective mass rate <span class="math notranslate nohighlight">\(J_{adv}\)</span> [MT<span class="math notranslate nohighlight">\(^{-1}\)</span>] is obtained from:</p>
<div class="math notranslate nohighlight">
\[
J_{adv} = Q\cdot C
\]</div>
<p>with concentration <span class="math notranslate nohighlight">\(C\)</span> [ML<span class="math notranslate nohighlight">\(^{-3}\)</span>].</p>
<p>Since <span class="math notranslate nohighlight">\(A\)</span> is constant and so is <span class="math notranslate nohighlight">\(Q\)</span>, then <span class="math notranslate nohighlight">\(v\)</span> has to be constant too. The consequence of qunatities being constant is that the transport of matter, in  resembles a horizontal pushing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A quick example: You can change the provided value</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let us find advective mass rate exiting a column.</span><span class="se">\n\n</span><span class="s2">Provided are:&quot;</span><span class="p">)</span>

<span class="n">R_1</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="c1"># cm, radius of the column</span>
<span class="n">ne_1</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># (), effective porosity</span>
<span class="n">v_1</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># cm/s, velocity</span>
<span class="n">C_1</span>   <span class="o">=</span> <span class="mi">2</span> <span class="c1"># mg/L, concentration</span>

<span class="c1"># intermediate calculation</span>
<span class="n">A_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R_1</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># Column surface area</span>
<span class="n">Q_1</span> <span class="o">=</span> <span class="n">ne_1</span><span class="o">*</span><span class="n">A_1</span><span class="o">*</span><span class="n">v_1</span> <span class="c1"># cm^3/s, discharge</span>

<span class="c1">#solution</span>
<span class="n">J_adv</span> <span class="o">=</span> <span class="n">Q_1</span><span class="o">*</span><span class="n">C_1</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radius = </span><span class="si">{}</span><span class="s2"> cm</span><span class="se">\n</span><span class="s2">Water flow rate = </span><span class="si">{}</span><span class="s2"> cm/s</span><span class="se">\n</span><span class="s2">Input concentration = </span><span class="si">{}</span><span class="s2"> mg/L and</span><span class="se">\n</span><span class="s2">Effective porosity = </span><span class="si">{:02.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R_1</span><span class="p">,</span> <span class="n">v_1</span><span class="p">,</span> <span class="n">C_1</span><span class="p">,</span> <span class="n">ne_1</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The resulting advective mass flow rate is </span><span class="si">{:02.4f}</span><span class="s2"> mg/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">J_adv</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A quick example: You can change the provided value

Let us find advective mass rate exiting a column.

Provided are:
Radius = 0.25 cm
Water flow rate = 0.02 cm/s
Input concentration = 2 mg/L and
Effective porosity = 0.30 

The resulting advective mass flow rate is 0.0024 mg/s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simulating advection 1D</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulating advective flow</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">N</span><span class="o">=</span> <span class="mi">100</span> <span class="c1"># number of cell - i.e. compartment a column is divided into</span>
<span class="n">c0</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># initial concentration</span>
<span class="n">cin</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># input concentration</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">c0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">))</span> <span class="c1"># initializing - i.e., all compartment has zero conc.</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># number of time steps- we make it equivalent to cell number.</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># &quot;roll&quot; is numpy function for shifting</span>
    <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cin</span> <span class="c1"># make the first cell = cin again. This is because np.roll uses the last value as the first one.</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;space (m)&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration (mg/L)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">cin</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulating advective flow
</pre></div>
</div>
<img alt="../../../_images/21_conservative_transport_6_1.png" src="../../../_images/21_conservative_transport_6_1.png" />
</div>
</div>
</section>
<section id="d-advection-in-variable-cross-section">
<h3><span class="section-number">1.3.3. </span>1D advection in variable cross-section<a class="headerlink" href="#d-advection-in-variable-cross-section" title="Permalink to this headline">#</a></h3>
<p>In the just completed case, the column was of uniform diameter. So, what happens when:</p>
<p>In this case the equation of continuity has to be explored. The continuity equation for variable cross section is:</p>
<p><span class="math notranslate nohighlight">\(
Q_1=Q_2
\)</span></p>
<p><span class="math notranslate nohighlight">\(
A_1 v_1 = A_2 v_2
\)</span></p>
<p>As <span class="math notranslate nohighlight">\(Q_1=Q_2= Q\)</span>, and when <span class="math notranslate nohighlight">\(A\)</span> changes then, <span class="math notranslate nohighlight">\(v\)</span> has to change as well. In this case considering that <span class="math notranslate nohighlight">\(n_e\)</span> is spatially constant, <span class="math notranslate nohighlight">\(v\)</span> will be inversely proportional to the cross-section. i.e., increase in <span class="math notranslate nohighlight">\(A\)</span> will result to decrease in <span class="math notranslate nohighlight">\(v\)</span> and vice-versa.</p>
<p>Based on this, the mass (patch in the figure), is actually equal in both figure and they are onyl spread out laterally. In other words, as cross-section increased and velocity decreased, the mass extension is reduced along the flow direction. The effect of <em>advection</em> is that the <em>concentration</em>, which is the total mass per litre of groundwater, remains unchanged in the patched mass area.</p>
</section>
<section id="is-advection-enough">
<h3><span class="section-number">1.3.4. </span>Is advection enough?<a class="headerlink" href="#is-advection-enough" title="Permalink to this headline">#</a></h3>
<p>Probably not. Advection may only be possible in uniformly packed porous medium with also perfectly uniform particle size distribution of medium particles. This is rather exception. In normal cases, the the particle transport will spread out leading some matter exiting earlier then remaining others. This is explained by process called <strong>mechanical dispersion</strong>.</p>
<figure class="align-center" id="ad-dis">
<a class="reference internal image-reference" href="../../../_images/T9_f3.png"><img alt="../../../_images/T9_f3.png" src="../../../_images/T9_f3.png" style="width: 476.7px; height: 237.99999999999997px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.2 </span><span class="caption-text">Advection-dispersion processes</span><a class="headerlink" href="#ad-dis" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<blockquote>
<div><p>Note: 1D only have longitudinal dispersivity. Transverse dispersivity is 2D/3D property
This is a footnote reference.</p>
</div></blockquote>
</section>
</section>
<section id="mechanical-dispersion">
<h2><span class="section-number">1.4. </span>Mechanical dispersion<a class="headerlink" href="#mechanical-dispersion" title="Permalink to this headline">#</a></h2>
<p><strong>Mechanical dispersion</strong> can result due to alone or combination of several porous medium and flow hydraulics properties. In general the following three reasons are considered when explaining the mechanical dispersion process:</p>
<figure class="align-center" id="mech-dis">
<a class="reference internal image-reference" href="../../../_images/T9_f4.png"><img alt="../../../_images/T9_f4.png" src="../../../_images/T9_f4.png" style="width: 598.8000000000001px; height: 146.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.3 </span><span class="caption-text">Mechanical dispersion mechanisms</span><a class="headerlink" href="#mech-dis" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<blockquote>
<div><p>a.  The varying flow velocities across each individual pore. A <strong>parabolic velocity profile</strong> results as close to the surface there is resistance to flow and the maximum velocity is at the centreline.</p>
</div></blockquote>
<blockquote>
<div><p>b. Different flow velocities in different pores. Pore sizes can vary due to different particle sizes and also due to non-uniform compaction. Larger pore will then have higher velocity compared to smaller pores.</p>
</div></blockquote>
<blockquote>
<div><p>c. Varying flow paths of individual flow streams. The water streams can take its own path around the particles. This can lead some taking shorter exit path compared to other streams.</p>
</div></blockquote>
<p>These effects, either individually or any combination, result in different transport distances and different transport times, respectively. Thus, matter carried by streamline will also have different transport distances and different times- or the solute are <strong>dispersed</strong>.</p>
<section id="dispersive-mass-flow-rate">
<h3><span class="section-number">1.4.1. </span>Dispersive Mass flow rate<a class="headerlink" href="#dispersive-mass-flow-rate" title="Permalink to this headline">#</a></h3>
<p>The dispersive mass flow rate <span class="math notranslate nohighlight">\(J_{disp, m}\)</span> [MT<span class="math notranslate nohighlight">\(^{-1}\)</span>] due to mechanical dispersion in porous media is:</p>
<ul class="simple">
<li><p>propertional to the cross-sectional area <span class="math notranslate nohighlight">\(A\)</span></p></li>
<li><p>proportional to the linear velocity, <span class="math notranslate nohighlight">\(v\)</span></p></li>
<li><p>proportional to the difference in concentration <span class="math notranslate nohighlight">\(\Delta C\)</span> between transport points</p></li>
<li><p>inversely propertional to the transport distance <span class="math notranslate nohighlight">\(L\)</span></p></li>
</ul>
<p>These jointly results to : $<span class="math notranslate nohighlight">\( 
\begin{align*}
J_{disp, m} &amp;\propto -n_e \cdot A \cdot v \cdot \frac{\Delta C}{L}\\
J_{disp, m} &amp;= - \alpha \cdot n_e \cdot A \cdot v \cdot \frac{\Delta C}{L}
\end{align*} \)</span>$</p>
<p>The ratio <span class="math notranslate nohighlight">\(\frac{\Delta C}{L}\)</span> [ML<span class="math notranslate nohighlight">\(^{-4}\)</span>] is called <strong>concentration gradient</strong>. The <strong>negative</strong> sign is to indicate that dispersive mass flow is from region with higher concentrations to regions with lower concentrations.</p>
<p><span class="math notranslate nohighlight">\(\alpha\)</span>[L] is proportionality constant called <strong>dispersivity</strong>. This quantity equals the value of the dispersive mass flow through a unit cross-sectional area for a unit concentration gradient and a unit linear velocity.</p>
</section>
<section id="dispersivity-and-mechanical-dispersion-coefficient">
<h3><span class="section-number">1.4.2. </span>Dispersivity and Mechanical Dispersion coefficient<a class="headerlink" href="#dispersivity-and-mechanical-dispersion-coefficient" title="Permalink to this headline">#</a></h3>
<p>It is more convinient to use dispersivity together with groundwater velocity. Thus, a qunatity called <strong>mechnical dispersion coefficient</strong> <span class="math notranslate nohighlight">\(D_{mech}\)</span> [L<span class="math notranslate nohighlight">\(^2\)</span>T<span class="math notranslate nohighlight">\(^{-1}\)</span>] is defined as:</p>
<div class="math notranslate nohighlight">
\[
D_{mech} = \alpha \cdot v
\]</div>
<p>Following the equation, the <span class="math notranslate nohighlight">\(D_{mech}\)</span> is a qunatity that is dependent on both the properties of porous medium, which is characterized by dispersivity (<span class="math notranslate nohighlight">\(\alpha\)</span>) and the property of flow hydrauclics that is characterized by flow velocity (<span class="math notranslate nohighlight">\(v\)</span>).</p>
<p>Using mechanical dispersion coefficient, the dispersive mass flow can be redefine as</p>
<div class="math notranslate nohighlight">
\[
J_{disp, m} = -  n_e \cdot A \cdot D_{mech} \cdot \frac{\Delta C}{L}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A quick example: You can change the provided values</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let us find dispersive mass rate exiting a column.</span><span class="se">\n\n</span><span class="s2">Provided are:&quot;</span><span class="p">)</span>

<span class="n">L_2</span>  <span class="o">=</span> <span class="mi">50</span> <span class="c1"># cm, length of the pipe</span>
<span class="n">R_2</span>  <span class="o">=</span> <span class="mf">0.25</span> <span class="c1"># cm, radius of the column</span>
<span class="n">ne_2</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># (), effective porosity</span>
<span class="n">v_2</span>  <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># cm/s, velocity</span>
<span class="n">Ci_2</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># mg/L, inlet concentration</span>
<span class="n">Co_2</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># mg/L, outlet concentration</span>
<span class="n">a_2</span>  <span class="o">=</span> <span class="mi">1</span> <span class="c1"># cm, dispersivity</span>

<span class="c1"># intermediate calculation</span>
<span class="n">A_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R_2</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># Column surface area</span>
<span class="n">Cg_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ci_2</span><span class="o">-</span><span class="n">Co_2</span><span class="p">)</span><span class="o">/</span><span class="n">L_2</span> <span class="c1"># mg/L-cm, concentration gradient</span>

<span class="c1">#solution</span>
<span class="n">Jm_dis</span> <span class="o">=</span> <span class="n">ne_2</span><span class="o">*</span><span class="n">A_2</span><span class="o">*</span><span class="n">a_2</span><span class="o">*</span><span class="n">v_2</span><span class="o">*</span><span class="n">Cg_2</span>



<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Length of column = </span><span class="si">{}</span><span class="s2"> cm</span><span class="se">\n</span><span class="s2">Radius of column = </span><span class="si">{}</span><span class="s2"> cm</span><span class="se">\n</span><span class="s2">Water flow rate = </span><span class="si">{}</span><span class="s2"> cm/s</span><span class="se">\n</span><span class="s2">Inlet concentration = </span><span class="si">{}</span><span class="s2"> mg/L</span><span class="se">\n</span><span class="s2">Outlet concentration = </span><span class="si">{}</span><span class="s2"> mg/L </span><span class="se">\</span>
<span class="se">\n</span><span class="s2">Effective porosity = </span><span class="si">{:02.2f}</span><span class="se">\n</span><span class="s2">Dispersivity = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">L_2</span><span class="p">,</span><span class="n">R_2</span><span class="p">,</span> <span class="n">v_2</span><span class="p">,</span> <span class="n">Ci_2</span><span class="p">,</span> <span class="n">Co_2</span><span class="p">,</span><span class="n">ne_2</span><span class="p">,</span> <span class="n">a_2</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The resulting dispersive mass flow is </span><span class="si">{:02.4f}</span><span class="s2"> mg/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Jm_dis</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A quick example: You can change the provided values

Let us find dispersive mass rate exiting a column.

Provided are:
Length of column = 50 cm
Radius of column = 0.25 cm
Water flow rate = 0.02 cm/s
Inlet concentration = 10 mg/L
Outlet concentration = 2 mg/L 
Effective porosity = 0.30
Dispersivity = 1 

The resulting dispersive mass flow is 0.0002 mg/s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Simulating mechanical dispersion</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulating mechanical dispersion</span><span class="se">\n</span><span class="s2">You can change input values to see the effect&quot;</span> <span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">c0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">cin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Neumann</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="c1"># Neumann number ensures that transport is combination of adv and disp.</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">c0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">c0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="n">c1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="c1">#dispersion component using Neumann number (D. Dt/Dx² -D= Delta )</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Neumann</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">]);</span> <span class="c1"># FD stensil for d²C/dx²</span>
           
    <span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Neumann</span><span class="o">*</span><span class="p">(</span><span class="n">cin</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="c1"># the first cell value</span>
    <span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Neumann</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span> <span class="c1"># the lass cell value</span>
    <span class="n">c1</span> <span class="o">=</span><span class="n">c2</span><span class="p">;</span>
    
    <span class="c1">#shifting cell - advection component</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>  
    <span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cin</span><span class="p">;</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">T</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;space (m)&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration (mg/L)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">cin</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulating mechanical dispersion
You can change input values to see the effect
</pre></div>
</div>
<img alt="../../../_images/21_conservative_transport_13_1.png" src="../../../_images/21_conservative_transport_13_1.png" />
</div>
</div>
</section>
<section id="hydrodynamic-dispersion">
<h3><span class="section-number">1.4.3. </span>Hydrodynamic Dispersion<a class="headerlink" href="#hydrodynamic-dispersion" title="Permalink to this headline">#</a></h3>
<p>In groundwater transport study mechanical dispersion and diffusion coefficient are summed up and a common term <strong>hydrodynamic dispersion</strong> <span class="math notranslate nohighlight">\(D_{hyd}\)</span> [L<span class="math notranslate nohighlight">\(^2\)</span>T<span class="math notranslate nohighlight">\(^{-1}\)</span>]. However, the diffusion coefficient <span class="math notranslate nohighlight">\(D\)</span> used in diffusion mass flow equation is valid for liquid water. Groundwater exist with solid porous medium. Thus, pore diffusion coefficient <span class="math notranslate nohighlight">\(D_p\)</span> [L<span class="math notranslate nohighlight">\(^2\)</span>T<span class="math notranslate nohighlight">\(^{-1}\)</span>] is considered. In general:</p>
<div class="math notranslate nohighlight">
\[
D_p &lt; D
\]</div>
<p>and it is frequently assumed that</p>
<div class="math notranslate nohighlight">
\[
D_p = n_e \cdot D
\]</div>
<p>where <span class="math notranslate nohighlight">\(n_e\)</span> is effectively porosity. Several other emperical formulae are found in literature relating <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(D_p\)</span>. With <span class="math notranslate nohighlight">\(D_p\)</span>, defined the <strong>hydrodynamic dispersion</strong> is defined as:</p>
<div class="math notranslate nohighlight">
\[
D_{hyd} = D_{mech} + D_p = \alpha \cdot v + D_p = \alpha \cdot v + n_e \cdot D
\]</div>
</section>
</section>
<section id="d-diffusion">
<h2><span class="section-number">1.5. </span>1D Diffusion<a class="headerlink" href="#d-diffusion" title="Permalink to this headline">#</a></h2>
<p>Contrasting with the advection and mechanical dispersion - mostly a flow influenced transport processes, the <strong>diffusion</strong> led transport depends on <strong>concentration gradient</strong>, i.e., flow is not required for transport.</p>
<p>The 1D diffusion transpor is found be:</p>
<ul class="simple">
<li><p>proportional to the cross-sectional area <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>proportional to the concentration gradient <span class="math notranslate nohighlight">\(\frac{\Delta C}{L}\)</span></p></li>
</ul>
<p>The diffusive mass transport <span class="math notranslate nohighlight">\(J_{diff}\)</span> [MT<span class="math notranslate nohighlight">\(^{-1}\)</span>] is thus:</p>
<p><span class="math notranslate nohighlight">\(
\begin{align*}
J_{diff} &amp;\propto - A\cdot\frac{\Delta C}{L}\\
J_{diff} &amp;= - D \cdot A\cdot\frac{\Delta C}{L}\\
\end{align*} 
\)</span></p>
<p><span class="math notranslate nohighlight">\(D\)</span> [L<span class="math notranslate nohighlight">\(^2\)</span>T<span class="math notranslate nohighlight">\(^{-1}\)</span>] is the proportional coefficient called diffusion coefficient. And, the negative sign is for indicating that the flow is from the region with higher concentration to the region with lower concentration. As can be observed from the equation, <span class="math notranslate nohighlight">\(D\)</span> will equal <span class="math notranslate nohighlight">\(J_{diff}\)</span> for unit cross-section for a unit concentration gradient. The value of <span class="math notranslate nohighlight">\(D\)</span> of dissolved chemicals in liquid water (not exactly in groundwater, which is water in porous media) are mostly in the range from <span class="math notranslate nohighlight">\(10^{-10}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s -  <span class="math notranslate nohighlight">\(10^{-9}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s. The value of <span class="math notranslate nohighlight">\(D\)</span> of chemicals in gases are larger by about four orders of magnitude, i.e., the range in this case from from <span class="math notranslate nohighlight">\(10^{-6}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s -  <span class="math notranslate nohighlight">\(10^{-5}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s.</p>
<p>The diffusion phenomena can be demonstrated from the figure below. The fig shows spread of solute in the absence of flow (<span class="math notranslate nohighlight">\(v=0\)</span> and consequently <span class="math notranslate nohighlight">\(Q=0\)</span>). The spread continues with time <span class="math notranslate nohighlight">\(t\)</span> until solute concentration in the entire medium is leveled.</p>
<figure class="align-center" id="dif">
<a class="reference internal image-reference" href="../../../_images/T9_f5.png"><img alt="../../../_images/T9_f5.png" src="../../../_images/T9_f5.png" style="width: 483.59999999999997px; height: 196.79999999999998px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.4 </span><span class="caption-text">The diffusion phenomena</span><a class="headerlink" href="#dif" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Simulating diffusion </span><span class="se">\n</span><span class="s2">You can change input values to see the effect</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span> 
<span class="c1"># Initial Conditions</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># number of space compartment</span>
<span class="n">nt</span> <span class="o">=</span> <span class="mi">20</span>    <span class="c1">#the number of timesteps we want to calculate</span>
<span class="n">Neumann</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># [ ], Neumann number = D. Dt/Dx² -D= Delta</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>      <span class="c1">#a numpy array with nx elements all equal to 1.</span>
<span class="n">u</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">.5</span> <span class="o">/</span> <span class="n">dx</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">dx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1">#setting u = 2 between 0.5 and 1 as per our I.C.s</span>

<span class="c1"># Calculation</span>
<span class="n">un</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span> <span class="c1">#our placeholder array, un, to advance the solution in time</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>  <span class="c1">#iterate through time</span>
    <span class="n">un</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">##copy the existing values of u into un</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">un</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">Neumann</span> <span class="o">*</span> <span class="p">(</span><span class="n">un</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">un</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">un</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nx</span><span class="p">),</span> <span class="n">u</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;space (m)&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration (mg/L)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulating diffusion 
You can change input values to see the effect
</pre></div>
</div>
<img alt="../../../_images/21_conservative_transport_16_1.png" src="../../../_images/21_conservative_transport_16_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A quick example: You can change the provided values</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let us find diffusive mass rate exiting a column.</span><span class="se">\n\n</span><span class="s2">Provided are:&quot;</span><span class="p">)</span>

<span class="n">L_3</span>  <span class="o">=</span> <span class="mi">50</span> <span class="c1"># cm, length of the columns</span>
<span class="n">R_3</span>  <span class="o">=</span> <span class="mf">0.25</span> <span class="c1"># cm, radius of the column</span>
<span class="n">Ci_3</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># mg/L, inlet concentration</span>
<span class="n">Co_3</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># mg/L, outlet concentration</span>
<span class="n">D_3</span>  <span class="o">=</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">5</span> <span class="c1"># cm^2/s, dispersivity</span>

<span class="c1"># intermediate calculation</span>
<span class="n">A_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">R_3</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># Column surface area</span>
<span class="n">Cg_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ci_3</span><span class="o">-</span><span class="n">Co_3</span><span class="p">)</span><span class="o">/</span><span class="n">L_3</span> <span class="c1"># mg/L-cm, concentration gradient</span>

<span class="c1">#solution</span>
<span class="n">Jm_diff</span> <span class="o">=</span> <span class="n">A_3</span><span class="o">*</span><span class="n">D_3</span><span class="o">*</span><span class="n">Cg_3</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radius = </span><span class="si">{}</span><span class="s2"> cm</span><span class="se">\n</span><span class="s2">Length of the column = </span><span class="si">{}</span><span class="s2"> cm/s</span><span class="se">\n</span><span class="s2">Inlet concentration = </span><span class="si">{}</span><span class="s2"> mg/L</span><span class="se">\n</span><span class="s2">Outlet concentration = </span><span class="si">{}</span><span class="s2"> mg/L </span><span class="se">\</span>
<span class="se">\n</span><span class="s2">Diffusion Coefficient = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R_3</span><span class="p">,</span> <span class="n">L_3</span><span class="p">,</span> <span class="n">Ci_3</span><span class="p">,</span> <span class="n">Co_3</span><span class="p">,</span> <span class="n">D_3</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The resulting dispersive mass flux is </span><span class="si">{:02.7f}</span><span class="s2"> mg/s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Jm_diff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A quick example: You can change the provided values

Let us find diffusive mass rate exiting a column.

Provided are:
Radius = 0.25 cm
Length of the column = 50 cm/s
Inlet concentration = 10 mg/L
Outlet concentration = 2 mg/L 
Diffusion Coefficient = 1e-05 

The resulting dispersive mass flux is 0.0000003 mg/s
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3><span class="section-number">1.5.1. </span>Hydrodynamic Dispersion<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>In groundwater transport study mechanical dispersion and diffusion coefficient are summed up and a common term <strong>hydrodynamic dispersion</strong> <span class="math notranslate nohighlight">\(D_{hyd}\)</span> [L<span class="math notranslate nohighlight">\(^2\)</span>T<span class="math notranslate nohighlight">\(^{-1}\)</span>]. However, the diffusion coefficient <span class="math notranslate nohighlight">\(D\)</span> used in diffusion mass flow equation is valid for liquid water. Groundwater exist with solid porous medium. Thus, pore diffusion coefficient <span class="math notranslate nohighlight">\(D_p\)</span> [L<span class="math notranslate nohighlight">\(^2\)</span>T<span class="math notranslate nohighlight">\(^{-1}\)</span>] is considered. In general:</p>
<div class="math notranslate nohighlight">
\[
D_p &lt; D
\]</div>
<p>and it is frequently assumed that</p>
<div class="math notranslate nohighlight">
\[
D_p = n_e \cdot D
\]</div>
<p>where <span class="math notranslate nohighlight">\(n_e\)</span> is effectively porosity. Several other emperical formulae are found in literature relating <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(D_p\)</span>. With <span class="math notranslate nohighlight">\(D_p\)</span>, defined the <strong>hydrodynamic dispersion</strong> is defined as:</p>
<div class="math notranslate nohighlight">
\[
D_{hyd} = D_{mech} + D_p = \alpha \cdot v + D_p = \alpha \cdot v + n_e \cdot D
\]</div>
</section>
</section>
<section id="joint-action-of-transport-processes">
<h2><span class="section-number">1.6. </span>Joint Action of Transport Processes<a class="headerlink" href="#joint-action-of-transport-processes" title="Permalink to this headline">#</a></h2>
<p>The spread of conservative solute in an unconsolidated aquifer can be considered as a combined effect or superposition of advection, mechanical dispersion and pore diffusion processes. Thus, for the complete description of the transport process is then:</p>
<div class="math notranslate nohighlight">
\[
J = J_{adv} + J_{disp, m} + J_{diff} = J_adv + J_{disp, h}
\]</div>
<p>i.e,</p>
<div class="math notranslate nohighlight">
\[
J = n_e \cdot A \cdot A \cdot v \cdot C - n_e \cdot A\cdot\alpha \cdot v 
\frac{\Delta C}{L} - n_e \cdot A\cdot D_p \cdot \frac{\Delta C}{L}
\]</div>
<p>which simplifies to</p>
<div class="math notranslate nohighlight">
\[
J = n_e \cdot A\cdot v \cdot C - n_e \cdot A \cdot D_hyd \cdot\frac{\Delta C}{L}
\]</div>
<p>Thus the spread of solutes due to transport processes can be quantified by combining a mass budget and the corresponding laws of motion. The combination results in a <strong>Transport Equation</strong>, which is more commonly known as <em>advection-dispersion equation</em> or also, when energy transport is generally the case,  as <em>convection-dispersion equation</em>. The derivation of the transport equation can be found in standard hydrogeology texts. For the sake of completeness, the 1D (conservative) transport equation is:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial C}{\partial x} = - v\frac{\partial C}{\partial x} + D_{hyd}\frac{\partial^2 C}{\partial x^2}
\]</div>
<p>The solution of transport equation is thus Concentration varying in space and time, i.e., <span class="math notranslate nohighlight">\(C(x,t)\)</span>.</p>
</section>
<section id="analysis-of-conservative-transport-problem">
<h2><span class="section-number">1.7. </span>Analysis of conservative transport problem<a class="headerlink" href="#analysis-of-conservative-transport-problem" title="Permalink to this headline">#</a></h2>
<p>Several analytical solutions (discussed in modeling chapter) are available that very often let us understand which type - e.g. advection dominant or dispersion dominant, of the problem exist. Very useful solution is provided by Ogata and Banks (1961). The solution for a particular initial and boundary conditions (see reference text) is given as:</p>
<div class="math notranslate nohighlight">
\[
C(x, t) = \frac{1}{2}C_0 \Bigg[\text{erfc}\Bigg(\frac{x-v\cdot t}{2\sqrt{D_x \cdot t}}\Bigg)+ \exp\Bigg(\frac{v\cdot x}{D_x}\Bigg)\cdot \text{erfc}\Bigg(\frac{x+v\cdot t}{2\sqrt{D_x \cdot t}}\Bigg)\Bigg]
\]</div>
<p>where, <span class="math notranslate nohighlight">\(C_0\)</span> is continuous input concentration. More often in groundwater studies, the term <span class="math notranslate nohighlight">\(\text{erfc}\Big(\frac{x+v\cdot t}{2\sqrt{D_x \cdot t}}\Big)\to 0 \)</span>. This simplifies the Ogata and Banks (1961) solution to</p>
<div class="math notranslate nohighlight">
\[
C(x, t) = \frac{1}{2}C_0 \Bigg[\text{erfc}\Bigg(\frac{x-v\cdot t}{2\sqrt{D_x \cdot t}}\Bigg)\Bigg]
\]</div>
<p>This solution can be used to evaluate the dominant front between advection and dispersion for example.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Ogata and Banks (1961) scenario</p>
<figure class="align-right" id="j-ad-dis">
<a class="reference internal image-reference" href="../../../_images/T9_f6.png"><img alt="../../../_images/T9_f6.png" src="../../../_images/T9_f6.png" style="width: 559.6px; height: 237.20000000000002px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.5 </span><span class="caption-text">Joint action of advection and dispersion
<code class="docutils literal notranslate">&#160; </code></span><a class="headerlink" href="#j-ad-dis" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simulating Ogata and Banks (1961) for evaluation dominant front.</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">C0</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Dx</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">v</span> <span class="o">=</span> <span class="mi">5</span><span class="c1"># change v and t together  to observe the dominant front.</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># </span>


<span class="n">C</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">C0</span><span class="o">*</span><span class="n">erfc</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Dx</span><span class="o">*</span><span class="n">t</span><span class="p">)))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="o">/</span><span class="n">C0</span><span class="p">)</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">*</span><span class="mi">5</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="n">t2</span>
<span class="n">C1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">C0</span><span class="o">*</span><span class="n">erfc</span><span class="p">((</span><span class="n">x1</span><span class="o">-</span><span class="n">v</span><span class="o">*</span><span class="n">t2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Dx</span><span class="o">*</span><span class="n">t2</span><span class="p">)))</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">C1</span><span class="o">/</span><span class="n">C0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Normalized concentration $C/C_0$ (-)&quot;</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance (m)&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;time 1&quot;</span><span class="p">,</span> <span class="s2">&quot;time 2&quot;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/21_conservative_transport_22_0.png" src="../../../_images/21_conservative_transport_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#from IPython.core.interactiveshell import InteractiveShell</span>
<span class="c1">#InteractiveShell.ast_node_interactivity = &quot;all&quot; </span>

<span class="n">Latex</span><span class="p">(</span><span class="s2">&quot;A quick example to present the relative importance of different mass flow in the transport of solute </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">A</span>  <span class="o">=</span>  <span class="mi">1</span> <span class="c1"># m², =ne.A,  cross-sectional area, with ne= eff. porosity</span>
<span class="n">v</span>  <span class="o">=</span>  <span class="mi">1</span> <span class="c1"># m/d, linear velocity</span>
<span class="n">C</span>  <span class="o">=</span>  <span class="mi">1</span> <span class="c1"># mg/L = 1 g/m^3, concentration</span>
<span class="n">D</span>  <span class="o">=</span>  <span class="mi">1</span> <span class="c1"># m, transport disntance</span>
<span class="n">gr</span> <span class="o">=</span>  <span class="mi">1</span> <span class="c1"># g/m⁴, Delta C/L, conc. gradient</span>
<span class="n">Al</span> <span class="o">=</span>  <span class="mf">0.1</span> <span class="c1"># m, dispersivity</span>
<span class="n">Dp</span> <span class="o">=</span>  <span class="mi">10</span><span class="o">**-</span><span class="mi">5</span> <span class="c1"># m²/d, pore diff. coefficient</span>

<span class="c1"># computation</span>
<span class="n">Jadv</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">C</span>
<span class="n">Jdisp</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">Al</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">gr</span>
<span class="n">Jdiff</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">Dp</span><span class="o">*</span><span class="n">gr</span>


<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Latex</span>
<span class="n">Latex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;\begin</span><span class="si">{eqnarray}</span><span class="s2"></span>
<span class="s2">J_</span><span class="si">{adv}</span><span class="s2"> &amp; = n_e\cdot A \cdot v \cdot C \\</span>
<span class="s2">J_</span><span class="si">{dis}</span><span class="s2"> &amp; = n_e\cdot A \cdot \alpha  \cdot  v \cdot \frac{\Delta C}</span><span class="si">{L}</span><span class="s2">  \\</span>
<span class="s2">J_</span><span class="si">{diff}</span><span class="s2"> &amp; = n_e\cdot A \cdot D_p  \cdot \frac{\Delta C}</span><span class="si">{L}</span><span class="s2"> </span>
<span class="s2">\end</span><span class="si">{eqnarray}</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>


<span class="c1">#output</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The contribution of advective flow is: </span><span class="si">{0:0.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Jadv</span><span class="p">),</span> <span class="s2">&quot;g/d </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The contribution of dispersive flow is: </span><span class="si">{0:0.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Jdisp</span><span class="p">),</span> <span class="s2">&quot;g/d </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The contribution of diffusive flow is: </span><span class="si">{0:0.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Jdiff</span><span class="p">),</span> <span class="s2">&quot;g/d </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> The contribution of advective flow is: 1.00 g/d 

The contribution of dispersive flow is: 0.10 g/d 

The contribution of diffusive flow is: 1.0e-05 g/d 
</pre></div>
</div>
</div>
</div>
<p>In general, <span class="math notranslate nohighlight">\(J_{adv} &gt; J_{dis} \)</span> and  <span class="math notranslate nohighlight">\(J_{disp} &gt;&gt; J_{diff} \)</span></p>
</section>
<section id="concnetration-profiles-and-breakthrough-curves">
<h2><span class="section-number">1.8. </span>Concnetration Profiles and Breakthrough Curves<a class="headerlink" href="#concnetration-profiles-and-breakthrough-curves" title="Permalink to this headline">#</a></h2>
<p><em>Concentration profiles</em> and <em>Breakthrough Curves</em> are very generally used to visualize and analyze the solute transport results.</p>
<p><strong>Conentration profiles</strong> represents  the solute concentration as a function of a space coordinate at fixed time level. Normalized concentration <span class="math notranslate nohighlight">\(C/C_0\)</span>, with <span class="math notranslate nohighlight">\(C_0\)</span> is geneally used in <span class="math notranslate nohighlight">\(y\)</span>-axis against distance <span class="math notranslate nohighlight">\(x\)</span> along <span class="math notranslate nohighlight">\(x-\)</span>axis.</p>
<p>The <em>concentration profile</em> can be visualize as in the figure below:</p>
<figure class="align-center" id="c-profile">
<a class="reference internal image-reference" href="../../../_images/T9_f7.png"><img alt="../../../_images/T9_f7.png" src="../../../_images/T9_f7.png" style="width: 454.5px; height: 430.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.6 </span><span class="caption-text">Concentration profile</span><a class="headerlink" href="#c-profile" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An example code for obtaining concentration profile </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Input        </span>
<span class="n">Cb</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># mg/L  # </span>
<span class="n">Ca</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># mg/L  </span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># m²/d  </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span> <span class="c1"># change time as you like - limit to four</span>

<span class="c1"># dont change anything from here</span>

<span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">Ca</span> <span class="o">+</span> <span class="p">(</span><span class="n">Cb</span><span class="o">-</span><span class="n">Ca</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">A</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0 day&quot;</span><span class="p">,</span> <span class="s2">&quot;First time&quot;</span><span class="p">,</span> <span class="s2">&quot;Second time&quot;</span><span class="p">,</span> <span class="s2">&quot;third time&quot;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">);</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration (mg/L)&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance (m)&quot;</span><span class="p">)</span>

<span class="n">f1</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="c1"># evaluate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>An example code for obtaining concentration profile 
</pre></div>
</div>
<img alt="../../../_images/21_conservative_transport_26_1.png" src="../../../_images/21_conservative_transport_26_1.png" />
</div>
</div>
<p><strong>Breakthrough Curves</strong>, an alternative to <em>concentration profile</em> provides the solute concentration as a function of time at specified observation locations, i.e., along <span class="math notranslate nohighlight">\(y-\)</span>axis <span class="math notranslate nohighlight">\(C\)</span> or normalized <span class="math notranslate nohighlight">\(C/C_0\)</span> is used and along the <span class="math notranslate nohighlight">\(x-\)</span>axis time <span class="math notranslate nohighlight">\(t\)</span> information is provided. The graphics below schematically illustrates th <em>breakthrough curve</em> visualization</p>
<figure class="align-center" id="break">
<a class="reference internal image-reference" href="../../../_images/T9_f7.png"><img alt="../../../_images/T9_f7.png" src="../../../_images/T9_f7.png" style="width: 454.5px; height: 430.5px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1.7 </span><span class="caption-text">The break-through curve</span><a class="headerlink" href="#break" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An example code for obtaining Breakthrough curve </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="c1"># dont change anything from here</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">Ca</span> <span class="o">+</span> <span class="p">(</span><span class="n">Cb</span><span class="o">-</span><span class="n">Ca</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">A</span><span class="p">)</span> <span class="c1"># Crank (1975) modified</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;distance 1&quot;</span><span class="p">,</span> <span class="s2">&quot;distance 2&quot;</span><span class="p">,</span> <span class="s2">&quot;distance 3&quot;</span><span class="p">,</span> <span class="s2">&quot;distance 4&quot;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">);</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration (mg/L)&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time (s)&quot;</span><span class="p">)</span>


<span class="c1"># Input        </span>
<span class="n">Cb</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># mg/L  # </span>
<span class="n">Ca</span> <span class="o">=</span> <span class="mi">2</span><span class="c1"># mg/L  </span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># m²/d  </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span> <span class="c1"># 0 = advective, change other numbers</span>

<span class="n">f1</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># evaluate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>An example code for obtaining Breakthrough curve 
</pre></div>
</div>
<img alt="../../../_images/21_conservative_transport_28_1.png" src="../../../_images/21_conservative_transport_28_1.png" />
</div>
</div>
</section>
<section id="additional-tool">
<h2><span class="section-number">1.9. </span>Additional Tool<a class="headerlink" href="#additional-tool" title="Permalink to this headline">#</a></h2>
<p>The additional tool: <span class="xref myst">1D-Advection-Dispersion Simulation Tool</span> simulates all the concepts that are provided above. The tool simulates:</p>
<ul class="simple">
<li><p>1D solute transport in porous media (e.g., laboratory column)</p></li>
<li><p>uses unifrom cross-section</p></li>
<li><p>steady-state water flow</p></li>
<li><p>input of tracer</p></li>
</ul>
<p>The output are then:</p>
<ul class="simple">
<li><p>spreading of tracer due to advection and mechanical dispersion</p></li>
<li><p>computation and graphical representation of a breakthrough curve</p></li>
<li><p>comparison with measured data.</p></li>
</ul>
</section>
<section id="chapter-quiz">
<h2><span class="section-number">1.10. </span>Chapter Quiz<a class="headerlink" href="#chapter-quiz" title="Permalink to this headline">#</a></h2>
<div class="cell tag_remove-input tag_hide-output docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="YErAkILBLzXK" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"> <style>:root {
    --medium-slate-blue: #6f78ffff;
    --orange-pantone: #f75c03ff;
    --russian-violet: #392061ff;
    --maximum-yellow-red: #ffc857ff;
    --viridian-green: #119da4ff;
    --incorrect-red: #c80202;
    --correct-green: #009113;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: auto auto;
    grid-gap: 10px;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: #c0c0c0;
    color: #fff;
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: #c0c0c0;
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem #999999;
}

.MCButton {
    background: #fafafa;
    border: 1px solid #eee;
    border-radius: 10px;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--medium-slate-blue);
    color: #fafafa;
    border-radius: 10px;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--orange-pantone);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn {
    padding: 10px;
    background: var(--russian-violet);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: #101010;
    font-size: 15pt;
}

.incorrect {
    color: var(--incorrect-red);
}

.correct {
    color: var(--correct-green);
}

.correctButton {
    /*
    background: var(--correct-green);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--incorrect-red);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--correct-green);
    }
}</style></div><script type="application/javascript">var questionsYErAkILBLzXK=[{"question": "In conservative transport:", "type": "multiple_choice", "answers": [{"answer": "Groundwater velocity is not important", "correct": false, "feedback": "Incorrect."}, {"answer": "Chemical reaction is not considered", "correct": true, "feedback": "Correct"}, {"answer": "Effective porosity is never a component", "correct": false, "feedback": "Incorrect."}, {"answer": "Is only concentration dependent ", "correct": false, "feedback": "Incorrect."}]}, {"question": "Advection refers to", "type": "multiple_choice", "answers": [{"answer": "Motion of particles due to groundwater flow", "correct": true, "feedback": "correct."}, {"answer": "Motion of particles due to spread of particles", "correct": false, "feedback": "Incorrect."}, {"answer": "Motion of particles due to chemical reaction ", "correct": false, "feedback": "Incorrect."}, {"answer": "Disruption of motion of particules", "correct": false, "feedback": "Incorrect"}]}, {"question": "Mechanical dispersion is  NOT  due to", "type": "many_choice", "answers": [{"answer": "Different groundwater flow velocities across each individual pore", "correct": false, "feedback": "Incorrect."}, {"answer": "Due to concentration of different compounds", "correct": true, "feedback": "Correct."}, {"answer": "Different groundwater flow velocities in different pores", "correct": false, "feedback": "Incorrect."}, {"answer": "The movement of water around the solids along different flowpaths.", "correct": false, "feedback": "Incorrect."}]}, {"question": "Dispersive mass flow due to mechanical dispersion  is NOT", "type": "multiple_choice", "answers": [{"answer": "Proportional to the cross-sectional area", "correct": false, "feedback": "Incorrect."}, {"answer": "Proportional to the linear velocity,", "correct": false, "feedback": "correct."}, {"answer": "Inversely proportional to the transport distance.", "correct": false, "feedback": "Incorrect."}, {"answer": "Inversely proportional to the difference in concentration,                                             ", "correct": true, "feedback": "Correct"}]}, {"question": "Dispersivity is ", "type": "multiple_choice", "answers": [{"answer": "Product of velocity and dispersion coefficient", "correct": false, "feedback": "Incorrect."}, {"answer": "Difference between velocity and dispersion coefficient", "correct": false, "feedback": "Incorrect."}, {"answer": " Ratio of dispersion coefficient and velocity", "correct": true, "feedback": "Correct"}, {"answer": "Product of velocity and concentration", "correct": false, "feedback": "Incorrect"}]}, {"question": "Hydrodynamic dispersion is", "type": "multiple_choice", "answers": [{"answer": "Sum of mechanical dispersion and pore diffusion", "correct": false, "feedback": "Incorrect."}, {"answer": "Sum of mechanical dispersion and advection", "correct": true, "feedback": "correct."}, {"answer": "Sum of pore diffusion and fluid diffusion", "correct": false, "feedback": "false."}, {"answer": "Product  of mechanical dispersion and pore diffusion", "correct": false, "feedback": "Incorrect"}]}, {"question": "Breakthrough curve refers to ", "type": "multiple_choice", "answers": [{"answer": "Plot of concentration versus conductivity", "correct": false, "feedback": "Inorrect."}, {"answer": "Plot of concentration versus space", "correct": false, "feedback": "Incorrect."}, {"answer": "Plot of concentration versus time", "correct": true, "feedback": "correct."}, {"answer": "Plot of concentration versus groundwater velocity", "correct": false, "feedback": "Incorrect."}]}, {"question": "Concentration profile refers to", "type": "multiple_choice", "answers": [{"answer": "Plot of concentration versus conductivity", "correct": false, "feedback": "Incorrect"}, {"answer": "Plot of concentration versus time", "correct": false, "feedback": "Incorrect"}, {"answer": "Plot of concentration versus groundwater velocity", "correct": false, "feedback": "Incorrect."}, {"answer": "Plot of concentration versus space", "correct": true, "feedback": "correct."}]}, {"question": "Diffusion is ", "type": "multiple_choice", "answers": [{"answer": "Spread of chemical due to groundwater velocity", "correct": false, "feedback": "Incorrect."}, {"answer": "Spread of chemical due to dispersivity", "correct": false, "feedback": "Incorrect."}, {"answer": "Spread of chemical due to hydraulic gradient", "correct": false, "feedback": "Incorrect."}, {"answer": "Spread of chemical due to concentration gradient     ", "correct": true, "feedback": "Correct."}]}];
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;

        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;

        iDiv.append(outerqDiv);

        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        //qDiv.textContent=qa.question;
        qDiv.innerHTML = jaxify(qa.question);

        outerqDiv.append(qDiv);

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if (qa.type == "multiple_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "many_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}

        {
        show_questions(questionsYErAkILBLzXK,  YErAkILBLzXK);
        }
        </script></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "iGW-TU-Dresden/iGW_Book",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content\transport\L9"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../flow/L8/18_wells.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">7. </span>Wells</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../L10/22_reactive_transport.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Reactive Mass Transport</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Dr Prabhas K. Yadav<br/>
  
      &copy; Copyright 2022.<br/>
    <div class="extra_footer">
      <div>
 All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>